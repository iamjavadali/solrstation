version: '3.1'

services:

  nginxproxymanagerpi:
    build:
      context: ./nginxproxymanager
    image: moneydontbuyclass/nginxproxymanagerpi
    container_name: nginxproxymanagerpi
    restart: unless-stopped
    ports:
      - 80:80
      - 443:443 
      - 81:81 #You can change port 81 to any avaiable port on your network.    
    volumes:
      - nginxproxymanagerpi:/data
      - /var/lib/docker/volumes/nginxproxymanager_nginxproxymanagerpi/_data/letsencrypt:/etc/letsencrypt
    depends_on:
      - nginxproxymanagerpidb
      - nginxproxymanagerpistats

  nginxproxymanagerpidb:
    build:
      context: ./mariadb
    image: moneydontbuyclass/nginxproxymanagerpidb
    container_name: nginxproxymanagerpidb
    restart: unless-stopped
    volumes:
      - /var/lib/docker/volumes/nginxproxymanager_nginxproxymanagerpi/mariadb:/var/lib/mysql

  nginxproxymanagerpistats:
    build:
      context: ./goaccess
    image: moneydontbuyclass/nginxproxymanagerpistats
    container_name: nginxproxymanagerpistats
    restart: unless-stopped
    ports:
      - 7880:7880   
    volumes:
      - /var/lib/docker/volumes/nginxproxymanager_nginxproxymanagerpi/_data/logs:/opt/log:ro

volumes:
  nginxproxymanagerpi: {}